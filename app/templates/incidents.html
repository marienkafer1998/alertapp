<link rel="stylesheet" href="{{ url_for('static', filename='incidents.css') }}">
{% extends "base.html" %}
{% block content %}
<h2>Incidents</h2>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link" href="">All</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="">Active</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="">Work-in progress</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="">Postoponed</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="">Done</a>
          </li>
      </ul>

      
     
    </div>
  </nav>

<table>
    <thead>
    <tr>
        <td>ID</td>
        <td>Status</td>
        <td>Type</td>
        <td>Start</td>
        <td>End</td>
        <td>User</td>
        <td>Alerts</td>
    </tr>
</thead>
{% set incidents = incidents|selectattr('status', '==', 'Active') %}

{% for incident in incidents|sort(attribute='status') %}
    <tr>
        <td><a href="{{ url_for('show_incident', id = incident.id) }}">
        <button type="button" class="btn btn-success" style="background-color:#167B91; border-radius: 50%;" > 
            {{ incident.id }}</button></a></td>

        <td>{{ incident.status }}</td>
        <td>{{ incident.TypeOfIncident.typeName }}</td>
        <td>{{ incident.start }}</td>
        {% if incident.end==None %}
            <td><p></p></td>
        {% else %}
            <td>{{ incident.end }}</td>
        {% endif %}
        <td>{{ incident.Users.fullName }}</td>
        <td>{% for alert in incident.alerts %}
            <b>#{{ alert.service }}</b>
            <b>#{{ alert.severity }}</b>
            {% endfor %}
        </td>
    </tr>
{% endfor %}
</table>

{% endblock %}